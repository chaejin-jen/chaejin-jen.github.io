<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Chaejin&#39;s Blog</title>
  <meta name="keywords" content="">
  <meta name="description" content="Chaejin&#39;s Blog">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="패스트캠퍼스 데이터 사이언스 완주반, 수학 학습목표선형대수1234567선형대수를 이용하여 기하학적 관점에서 데이터를 분해데이터를 바라보는 여러가지 방법고유값 분해, 특잇값 분해 등 행렬을 분석하는 여러 방법선형대수 데이터 분석에 필요한 도구   벡터와 행렬의 연산이 기하학적으로 어떤 의미인지 이해 벡터를 투영분해 투영분해 결과, 직선의 방정식을 벡터 연산으">
<meta property="og:type" content="website">
<meta property="og:title" content="Chaejin&#39;s Blog">
<meta property="og:url" content="https://chaejin-jen.github.io/inging/%EC%88%98%ED%95%99%EB%AA%A9%EC%B0%A8.html">
<meta property="og:site_name" content="Chaejin&#39;s Blog">
<meta property="og:description" content="패스트캠퍼스 데이터 사이언스 완주반, 수학 학습목표선형대수1234567선형대수를 이용하여 기하학적 관점에서 데이터를 분해데이터를 바라보는 여러가지 방법고유값 분해, 특잇값 분해 등 행렬을 분석하는 여러 방법선형대수 데이터 분석에 필요한 도구   벡터와 행렬의 연산이 기하학적으로 어떤 의미인지 이해 벡터를 투영분해 투영분해 결과, 직선의 방정식을 벡터 연산으">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-03-05T04:51:06.821Z">
<meta property="article:modified_time" content="2021-03-04T07:51:44.000Z">
<meta property="article:author" content="Chaejin Kim">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.png">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/darcula.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 5.4.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="hide-list">
        <div class="semicircle" data-title=" close">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.png"/>
</a>
<div class="author">
    <span>Chaejin Kim</span>
</div>

<div class="icon">
    
        
            <a title="rss"
               href="/atom.xml"
               target="_blank">
                
                    <i class="iconfont icon-rss"></i>
                
            </a>
        
    
        
            <a title="github"
               href="https://github.com/chaejin-jen"
               target="_blank">
                
                    <i class="iconfont icon-github"></i>
                
            </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
</div>




<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(9)</small>
            
        </div>
    </li>
    
        
            
                <li>
                    <div data-rel="DeepLearning">
                        <i class="fold iconfont icon-right"></i>
                        
                        DeepLearning
                        <small>(1)</small>
                        
                    </div>
                    
                        <ul class="sub hide">
                            
                                <li>
                                    <div data-rel="DeepLearning<--->Bagic3">
                                        
                                        Bagic3
                                        
                                            <small>(1
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                        </ul>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Algorithm">
                        <i class="fold iconfont icon-right"></i>
                        
                        Algorithm
                        <small>(3)</small>
                        
                    </div>
                    
                        <ul class="sub hide">
                            
                                <li>
                                    <div data-rel="Algorithm<--->Basic">
                                        
                                        Basic
                                        
                                            <small>(3
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                        </ul>
                    
                </li>
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
                <li>
                    <div data-rel="ComputerScience">
                        <i class="fold iconfont icon-right"></i>
                        
                        ComputerScience
                        <small>(1)</small>
                        
                    </div>
                    
                        <ul class="sub hide">
                            
                                <li>
                                    <div data-rel="ComputerScience<--->Bagic">
                                        
                                        Bagic
                                        
                                            <small>(1
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                        </ul>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="DataScience">
                        <i class="fold iconfont icon-right"></i>
                        
                        DataScience
                        <small>(4)</small>
                        
                    </div>
                    
                        <ul class="sub hide">
                            
                                <li>
                                    <div data-rel="DataScience<--->Math">
                                        <i class="fold iconfont icon-right"></i>
                                        
                                        Math
                                        
                                            <small>(4
                                                )</small>
                                        
                                    </div>
                                    
                                        <ul class="sub hide">
                                            
                                                <li>
                                                    <div data-rel="DataScience<--->MathBagic">
                                                        
                                                        Bagic
                                                        
                                                            <small>(4)</small>
                                                        
                                                    </div>
                                                </li>
                                            
                                        </ul>
                                    
                                </li>
                            
                        </ul>
                    
                </li>
            
        
    
        
            
        
    
</ul>
<div class="right-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  site_url"
               
               href="/about">About</a>
        
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="9">

<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="http://yelog.org/">叶落阁</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="outline-panel" style="display: none">
            <div class="right-title">Outline</div>
            <i class="iconfont icon-list" data-title="카테고리"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="이전"></i>
            <input id="local-search-input" />
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="대소 문자 구분"></i>
            <i class="iconfont icon-tag" data-title="태그검색"></i>
        </div>
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="검색 "></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="개요보기 "></i>
        </div>        
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Algorithm Basic</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Computer Science OS</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>DeepLearning Framework</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Math Basic</a>
            </li>
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        <a  class="All DataScience Math Bagic "
           href="/2021/03/08/DataScience/Math/%ED%96%89%EB%A0%AC/"
           data-tag="Math Basic"
           data-author="" >
            <span class="post-title" title="행렬">행렬</span>
            <span class="post-date" title="2021-03-08 20:38:35">2021/03/08</span>
        </a>
        
        <a  class="All DataScience Math Bagic "
           href="/2021/03/08/DataScience/Math/Bagic/%EB%B2%A1%ED%84%B0/"
           data-tag="Math Basic"
           data-author="" >
            <span class="post-title" title="벡터">벡터</span>
            <span class="post-date" title="2021-03-08 20:33:17">2021/03/08</span>
        </a>
        
        <a  class="All ComputerScience Bagic "
           href="/2021/03/07/ComputerScience/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/"
           data-tag="Computer Science OS"
           data-author="" >
            <span class="post-title" title="운영체제">운영체제</span>
            <span class="post-date" title="2021-03-07 16:26:55">2021/03/07</span>
        </a>
        
        <a  class="All DeepLearning Bagic3 "
           href="/2021/03/06/DeepLearning/Mit3/mitdeep1/"
           data-tag="DeepLearning Framework"
           data-author="" >
            <span class="post-title" title="밑바닥 부터 시작하는 딥러닝 3 (1탄!)">밑바닥 부터 시작하는 딥러닝 3 (1탄!)</span>
            <span class="post-date" title="2021-03-06 07:26:32">2021/03/06</span>
        </a>
        
        <a  class="All Algorithm Basic "
           href="/2021/03/06/CodeAlgorithm/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/"
           data-tag="Algorithm Basic"
           data-author="" >
            <span class="post-title" title="기본 핵심 알고리즘 (정렬, 탐색)">기본 핵심 알고리즘 (정렬, 탐색)</span>
            <span class="post-date" title="2021-03-06 07:26:31">2021/03/06</span>
        </a>
        
        <a  class="All DataScience Math Bagic "
           href="/2021/03/06/DataScience/Math/Bagic/%EC%88%98%ED%95%99%EA%B8%B0%ED%98%B8/"
           data-tag="Math Basic"
           data-author="" >
            <span class="post-title" title="수학 기호">수학 기호</span>
            <span class="post-date" title="2021-03-06 07:25:54">2021/03/06</span>
        </a>
        
        <a  class="All Algorithm Basic "
           href="/2021/03/06/CodeAlgorithm/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98%EB%B3%B5%EC%9E%A1%EB%8F%84/"
           data-tag="Algorithm Basic"
           data-author="" >
            <span class="post-title" title="알고리즘 복잡도">알고리즘 복잡도</span>
            <span class="post-date" title="2021-03-06 07:25:54">2021/03/06</span>
        </a>
        
        <a  class="All Algorithm Basic "
           href="/2021/03/06/CodeAlgorithm/%EC%9E%90%EB%A3%8C%EA%B5%AC%EC%A1%B0/"
           data-tag="Algorithm Basic"
           data-author="" >
            <span class="post-title" title="자료구조">자료구조</span>
            <span class="post-date" title="2021-03-06 07:25:53">2021/03/06</span>
        </a>
        
        <a  class="All DataScience Math Bagic "
           href="/2021/03/05/DataScience/Math/Bagic/%EC%88%98%EC%97%B4%EC%A7%91%ED%95%A9%EC%9D%98_%ED%95%A9%EA%B3%BC%EA%B3%B1/"
           data-tag="Math Basic"
           data-author="" >
            <span class="post-title" title="수열 집합의 합과 곱">수열 집합의 합과 곱</span>
            <span class="post-date" title="2021-03-05 14:29:56">2021/03/05</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="page-" class="article article-type-page" itemscope itemprop="blogPost">
    
    <div class="article-meta">
        
        
        
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2021-03-08 20:52:40'>2021-03-08 20:52</time>
        
    </div>
    <div class="article-meta">
        
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%EB%AA%A9%EC%B0%A8"><span class="toc-text">목차</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%EC%B5%9C%EC%86%8C%EC%9E%90%EC%8A%B9%EB%AC%B8%EC%A0%9C-least-square-problem"><span class="toc-text">최소자승문제(least square problem)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EC%96%B4%EB%94%94%EC%84%9C-%EB%82%98%EC%99%94%EC%9D%84%EA%B9%8C"><span class="toc-text">어디서 나왔을까?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EB%8B%B5%EC%9D%80-%EC%96%B4%EB%96%A4-%ED%98%95%ED%83%9C%EA%B0%80-%EB%82%98%EC%98%AC%EA%B9%8C"><span class="toc-text">답은 어떤 형태가 나올까?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Numpy-lstsq"><span class="toc-text">Numpy lstsq()</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%EA%B3%A0%EC%9C%A0%EB%B6%84%ED%95%B4"><span class="toc-text">고유분해</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EC%9A%94%EC%95%BD-%EA%B3%A0%EC%9C%A0%EB%B6%84%ED%95%B4%EC%9D%98-%EC%84%B1%EC%A7%88"><span class="toc-text">요약: 고유분해의 성질</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%ED%8A%B9%EC%9D%B4%EA%B0%92%EB%B6%84%ED%95%B4"><span class="toc-text">특이값분해</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%EA%B8%B0%EB%B3%B8%EC%88%98%ED%95%99"><span class="toc-text">기본수학</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%EC%82%BC%EA%B0%81%ED%95%A8%EC%88%98"><span class="toc-text">삼각함수</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%ED%99%95%EB%A5%A0-%EB%B6%84%ED%8F%AC"><span class="toc-text">확률 분포</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%EC%BD%94%EB%93%9C"><span class="toc-text">코드</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-text"></span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#numpy-linalg"><span class="toc-text">numpy.linalg</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#linalg-norm"><span class="toc-text">linalg.norm()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lstsq"><span class="toc-text">lstsq()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#matrix-rank"><span class="toc-text">matrix_rank()</span></a></li></ol></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<h1 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h1><p><code>w/W</code> : <strong>글 목차 확인</strong> 또는 글 목록 보기<br><code>s/S</code> : <strong>디렉토리 숨기기</strong> 또는 열기</p>
<!-- # 프로그래밍 분류

# 선형 연립방정식(system of linear equations)
: 복수의 미지수를 포함하는 복수의 선형 방정식
**연립일차방정식**이라고도 함

## 선형 연립방정식 표현
행렬과 벡터의 곱셈으로 표현하면 다음과 같다.
> $$ 
>Ax = b  
>$$  
$A, x, b$ 는 각각 **계수행렬(coefficient matrix), 미지수벡터(unknown vector), 상수벡터(constant vector)** 라고 부른다.

### 상세 설명
$x_1, x_2, \cdots, x_M$ 이라는 $M$ 개의 미지수를 가지는 $N$개의 선형 연립방정식은 일반적으로 다음과 같은 형태가 된다. 이 식에서 $a$와 $b$는 방정식의 계수다.

$$
\begin{matrix}
a_{11} x_1 & + \;& a_{12} x_2   &\; + \cdots + \;& a_{1M} x_M &\; = \;& b_1 \\
a_{21} x_1 & + \;& a_{22} x_2   &\; + \cdots + \;& a_{2M} x_M &\; = \;& b_2 \\
\vdots\;\;\; &   & \vdots\;\;\; &                & \vdots\;\;\; &     & \;\vdots \\
a_{N1} x_1 & + \;& a_{N2} x_2   &\; + \cdots + \;& a_{NM} x_M &\; = \;& b_N \\
\end{matrix}
$$


행렬과 벡터의 곱셈을 이용하면 위 선형 연립방정식은 다음처럼 간단하게 쓸 수 있다.

$$
\begin{bmatrix}
a_{11} & a_{12} & \cdots & a_{1M} \\
a_{21} & a_{22} & \cdots & a_{2M} \\
\vdots & \vdots & \ddots & \vdots \\
a_{N1} & a_{N2} & \cdots & a_{NM} \\
\end{bmatrix}
\begin{bmatrix}
x_1 \\ x_2 \\ \vdots \\ x_M
\end{bmatrix}
=
\begin{bmatrix}
b_1 \\ b_2 \\ \vdots \\ b_N
\end{bmatrix}
$$

이 식에서

$$
A = 
\begin{bmatrix}
a_{11} & a_{12} & \cdots & a_{1M} \\
a_{21} & a_{22} & \cdots & a_{2M} \\
\vdots & \vdots & \ddots & \vdots \\
a_{N1} & a_{N2} & \cdots & a_{NM} \\
\end{bmatrix}
, \;\;
x = 
\begin{bmatrix}
x_1 \\ x_2 \\ \vdots \\ x_M
\end{bmatrix}
, \;\;
b=
\begin{bmatrix}
b_1 \\ b_2 \\ \vdots \\ b_N
\end{bmatrix}
$$

라고 하면 다음처럼 쓸 수 있다.

$$ 
Ax = b  
$$

$A, x, b$ 는 각각 **계수행렬(coefficient matrix), 미지수벡터(unknown vector), 상수벡터(constant vector)**라고 부른다.

이 표현을 따르면 앞에서 예로 든 선형 연립방정식은 다음처럼 표현할 수 있다.

$$
Ax = b
$$

$$
A = 
\begin{bmatrix}
 1 & 1 & 0 \\
 0 & 1 & 1 \\
 1 & 1 & 1 \\
\end{bmatrix}, \;\;\;
x = \begin{bmatrix}
x_1 \\ x_2 \\ x_3
\end{bmatrix}, \;\;\;
b = \begin{bmatrix}
2 \\ 2 \\ 3
\end{bmatrix}
$$


### 선형 예측모형의 가중치벡터

선형 예측모형을 구하는 문제 : 계수행렬($A$)를 특징행렬 $X$, 미지수벡터($x$)를 가중치벡터 $w$로 둔 선형 연립방정식 문제이다.
> $Ax=b$ 에서 $Xw=b$ 로 바뀜

즉, 선형 예측모형의 가중치벡터를 구하는 문제는 선형 연립방정식을 푸는 것과 같다.


예를 들어 $N$개의 입력차원을 가지는 특징벡터 $N$개를 입력 데이터로 이용하고 이 입력에 대응하는 목푯값벡터를 출력하는 선형 예측모형을 생각하자.
<!-- $x\in\mathbb{R}^N, x \rightarrow y$ -->

<p>$$<br>\begin{matrix}<br>x_{11} w_1 &amp; + ;&amp; x_{12} w_2   &amp;; + \cdots + ;&amp; x_{1N} w_N &amp;; = ;&amp; y_1 \<br>x_{21} w_1 &amp; + ;&amp; x_{22} w_2   &amp;; + \cdots + ;&amp; x_{2N} w_N &amp;; = ;&amp; y_2 \<br>\vdots;;; &amp;   &amp; \vdots;;; &amp;                &amp; \vdots;;; &amp;     &amp; ;\vdots \<br>x_{N1} w_1 &amp; + ;&amp; x_{N2} w_2   &amp;; + \cdots + ;&amp; x_{NN} w_N &amp;; = ;&amp; y_N \<br>\end{matrix}<br>$$</p>
<p>즉,</p>
<p>$$<br>Xw = y<br>$$</p>
<p>이 예측 모형의 가중치벡터 $w$를 찾는 것은 계수행렬이 $X$, 미지수벡터가 $w$, 상수벡터가 $y$인 선형 연립방정식의 답을 찾는 것과 같다. 그리고 만약 계수행렬, 여기에서는 특징행렬 $X$의 역행렬 $X^{-1}$이 존재하면 다음처럼 가중치벡터를 구할 수 있다.</p>
<p>$$<br>w = X^{-1} y<br>$$</p>
<h2 id="최소자승문제-least-square-problem"><a href="#최소자승문제-least-square-problem" class="headerlink" title="최소자승문제(least square problem)"></a>최소자승문제(least square problem)</h2><blockquote>
<p>잔차를 최소화하는 문제  </p>
</blockquote>
<ul>
<li>잔차(residual) : 예측값과 목푯값의 차이 (벡터)</li>
<li>잔차제곱합, 벡터의 크기가 최소가 되는 값을 구한다<ul>
<li>즉, 벡터의 크기중 하나인 놈의 제곱을 구함</li>
<li>결국, <strong>벡터의 놈(norm)을 최소화</strong> 하는 문제</li>
</ul>
</li>
</ul>
<h3 id="어디서-나왔을까"><a href="#어디서-나왔을까" class="headerlink" title="어디서 나왔을까?"></a>어디서 나왔을까?</h3><p>미지수의 수와 방정식의 수를 고려해 볼 때 연립방정식에는 다음과 같은 세 종류가 있을 수 있다.</p>
<ol>
<li><p>방정식의 수가 미지수의 수와 같다. ($N = M$)</p>
</li>
<li><p>방정식의 수가 미지수의 수보다 적다. ($N &lt; M$)</p>
<ul>
<li>무수히 많은 해가 존재할 수 있다</li>
</ul>
</li>
<li><p><strong>방정식의 수가 미지수의 수보다 많다</strong>. <strong>($N &gt; M$)</strong></p>
<ul>
<li><p>모든 조건을 만족하는 <strong>해가 존재하지 않을 수 있다</strong></p>
</li>
<li><p>보통 데이터의 수는 입력차원보다 큰 경우가 많다.</p>
</li>
</ul>
</li>
</ol>
<p>하지만 꼭 양변이 <strong>정확하게 똑같지 않아도 된다면</strong>, 모든 조건을 <strong>비슷하게 맞추면</strong> 된다면 어떨까?</p>
<p>미지수의 개수보다 방정식의 개수가 많아서 선형 연립방정식으로 풀수 없는 문제는 <strong>좌변과 우변의 차이를 최소화</strong>하는 문제로 바꾸어 풀 수 있다. </p>
<h3 id="답은-어떤-형태가-나올까"><a href="#답은-어떤-형태가-나올까" class="headerlink" title="답은 어떤 형태가 나올까?"></a>답은 어떤 형태가 나올까?</h3><p>$A^TA$가 항상 정방 행렬이 된다는 점을 이용하여 답의 형태를 그려보자!</p>
<p>$$<br>Ax \approx b<br>$$</p>
<p>이 식의 양변에 $A^T$를 곱하면 각각 $A^TAx$와 $A^Tb$ 가 된다. 이 두 개의 벡터의 값이 같다고 일단 가정하자.</p>
<p>$$<br>A^TAx = A^Tb<br>$$</p>
<p>만약 정방 행렬 $A^TA$의 역행렬 $(A^TA)^{-1}$이 존재한다면</p>
<p>$$<br>(A^TA)^{-1}(A^TA)x = (A^TA)^{-1}A^Tb<br>$$</p>
<p>이 식을 정리하면 다음과 같다. </p>
<p>$$<br>x = ((A^TA)^{-1}A^T) b<br>$$</p>
<p>여기에서 행렬 $(A^TA)^{-1}A^T$ 를 행렬 $A$의 **의사역행렬(pseudo inverse)**이라고 하며 다음처럼 $A^{+}$ 로 표기한다. </p>
<p>$$<br>A^{+} = (A^TA)^{-1}A^T<br>$$</p>
<p>$$<br>x = A^+ b<br>$$</p>
<h3 id="Numpy-lstsq"><a href="#Numpy-lstsq" class="headerlink" title="Numpy lstsq()"></a>Numpy <code>lstsq()</code></h3><p>명령은 최소자승문제를 푸는 명령이다.</p>
<h1 id="고유분해"><a href="#고유분해" class="headerlink" title="고유분해"></a>고유분해</h1><h3 id="요약-고유분해의-성질"><a href="#요약-고유분해의-성질" class="headerlink" title="요약: 고유분해의 성질"></a>요약: 고유분해의 성질</h3><p>지금까지 나왔던 고유분해와 관련된 정리를 다시 한 번 요약하였다. 이 정리들은 데이터 분석에서 자주 사용되므로 잘 알아두자.</p>
<p>$N$차원 정방행렬 $A$에 대해 </p>
<ol>
<li>행렬 $A$는 $N$개의 고윳값-고유벡터를 가진다(복소수인 경우와 중복인 경우를 포함).</li>
<li>행렬의 <strong>대각합은 모든 고윳값의 합</strong>과 같다.</li>
<li>행렬의 <strong>행렬식은 모든 고윳값의 곱</strong>과 같다.</li>
<li>행렬 $A$가 <strong>대칭행렬</strong>이면 $N$개의 <strong>실수 고윳값</strong>을 가지며 고유벡터들이 서로 **직교(orthogonal)**이다.</li>
<li>행렬 $A$가 <strong>대칭행렬</strong>이고 고윳값이 모두 <strong>양수</strong>이면 <strong>양의 정부호(positive-definite)이고 역행렬이 존재한다</strong>. 역도 성립한다.</li>
<li>행렬 $A$가 어떤 행렬 $X$의 <strong>분산행렬</strong> $X^TX$이면 <strong>0 또는 양의 고윳값을 가진다</strong>.</li>
<li>행렬 $X\in\mathbf{R}^{N\times M} (N\geq M)$가 <strong>풀랭크이면 분산행렬 $X^TX$은 역행렬이 존재</strong>한다.</li>
</ol>
<hr>
<h1 id="특이값분해"><a href="#특이값분해" class="headerlink" title="특이값분해"></a>특이값분해</h1><hr>
<p>기댓값</p>
<p>$$<br>\text{E}[p(x)] = \int_{-\infty}^{\infty} xp(x)dx<br>$$</p>
<hr>
<p>기댓값의 성질</p>
<ul>
<li>확률변수가 아닌 상수 $c$에 대해 </li>
</ul>
<p>$$<br>\text{E}[c] = c<br>$$</p>
<ul>
<li>선형성</li>
</ul>
<p>$$<br>\text{E}[cX] = c \text{E}[X]<br>$$</p>
<p>$$<br>\text{E}[X + Y] = \text{E}[X] + \text{E}[Y]<br>$$</p>
<p>$$<br>\text{E}[c_1X + c_2Y] = c_1\text{E}[X] + c_2\text{E}[Y]<br>$$</p>
<hr>
<p>대칭분포 비대칭분포</p>
<p>표본평균, 표본중앙값, 표본최빈값은 분포의 모양에 따라 다음과 같은 특성을 보인다.</p>
<ul>
<li>분포가 표본평균을 기준으로 대칭인 대칭(symmetric)분포이면 표본중앙값은 표본평균과 같다.</li>
<li>분포가 대칭분포이면서 하나의 최고값만을 가지는 단봉분포이면 표본최빈값은 표본평균과 같다.</li>
<li>대칭분포를 비대칭으로 만드는 데이터가 더해지면 표본평균이 가장 크게 영향을 받고 표본최빈값이 가장 적게 영향을 받는다.</li>
</ul>
<p>다음 히스토그램은 대칭인 분포를 비대칭으로 만드는 데이터가 더해졌을 때 표본평균, 표본중앙값, 표본최빈값이 어떻게 변하는지를 보인다.</p>
<hr>
<hr>
<h1 id="기본수학"><a href="#기본수학" class="headerlink" title="기본수학"></a>기본수학</h1><h2 id="삼각함수"><a href="#삼각함수" class="headerlink" title="삼각함수"></a>삼각함수</h2><p>사인과 코사인을 합쳐서 삼각함수라고 한다.</p>
<p>$\sin\theta$ : $\theta$라는 각을 가지는 직각 삼각형에서 빗변(hypotenuse)과 높이(opposite)의 비율</p>
<p>$\cos\theta$ : $\theta$라는 각을 가지는 직각 삼각형에서 빗변(hypotenuse)과 밑변(adjacent)의 비율</p>
<p>$$<br>\sin\theta = \dfrac{a}{h}<br>$$</p>
<p>$$<br>\cos\theta = \dfrac{b}{h}<br>$$</p>
<pre><code class="python">plt.plot([0, 1], [0, 2], &#39;k-&#39;, lw=3)
plt.plot([0, 1], [0, 0], &#39;k-&#39;, lw=3)
plt.plot([1, 1], [0, 2], &#39;k-&#39;, lw=3)
plt.text(0.05, 1, &quot;빗변 h&quot;)
plt.text(0.35, -0.2, &quot;밑변 b&quot;)
plt.text(1.05, 1, &quot;높이 a&quot;)
plt.text(0.12, 0.06, r&quot;$\theta$&quot;)
plt.xticks(np.arange(-2, 4))
plt.yticks(np.arange(-1, 4))
plt.xlim(-1.1, 2.1)
plt.ylim(-0.5, 2.3)
plt.show()
</code></pre>
<p><img src="03.01%20%EC%84%A0%ED%98%95%EB%8C%80%EC%88%98%EC%99%80%20%ED%95%B4%EC%84%9D%EA%B8%B0%ED%95%98%EC%9D%98%20%EA%B8%B0%EC%B4%88_files/03.01%20%EC%84%A0%ED%98%95%EB%8C%80%EC%88%98%EC%99%80%20%ED%95%B4%EC%84%9D%EA%B8%B0%ED%95%98%EC%9D%98%20%EA%B8%B0%EC%B4%88_37_0.png" alt="png"></p>
<p>$\sin\theta$의 값은 $\theta$가 0에 가까워질수록 0에 가까워지고 $\theta$가 $90{}^{\circ}$에 가까워질수록 1에 가까워진다. </p>
<p>$$<br>\sin 0^{\circ} = 0<br>$$</p>
<p>$$<br>\sin 90^{\circ} = 1<br>$$</p>
<p>반대로 $\cos\theta$의 값은 $\theta$가 0에 가까워질수록 1에 가까워지고 $\theta$가 $90{}^{\circ}$에 가까워질수록 0에 가까워진다. </p>
<p>$$<br>\cos 0^{\circ} = 1<br>$$</p>
<p>$$<br>\cos 90^{\circ} = 0<br>$$</p>
<p>함수의 그래프로 표현하면 다음과 같다.</p>
<pre><code class="python">x = np.linspace(0, np.pi/2, 100)
y1 = np.sin(x)
y2 = np.cos(x)
plt.plot(x, y1, &#39;r--&#39;, lw=3,  label=r&quot;$\sin\theta$&quot;)
plt.plot(x, y2, &#39;b-&#39;, lw=3, label=r&quot;$\cos\theta$&quot;)
plt.legend()
plt.xticks([0, np.pi/4, np.pi/2], [r&#39;$0^&#123;\circ&#125;$&#39;, r&#39;$45^&#123;\circ&#125;$&#39;, r&#39;$90^&#123;\circ&#125;$&#39;])
plt.xlabel(r&quot;$\theta$&quot;)
plt.title(r&quot;$\sin\theta$와 $\cos\theta$의 그래프&quot;)
plt.show()
</code></pre>
<p><img src="03.01%20%EC%84%A0%ED%98%95%EB%8C%80%EC%88%98%EC%99%80%20%ED%95%B4%EC%84%9D%EA%B8%B0%ED%95%98%EC%9D%98%20%EA%B8%B0%EC%B4%88_files/03.01%20%EC%84%A0%ED%98%95%EB%8C%80%EC%88%98%EC%99%80%20%ED%95%B4%EC%84%9D%EA%B8%B0%ED%95%98%EC%9D%98%20%EA%B8%B0%EC%B4%88_39_0.png" alt="png"></p>
<h1 id="확률-분포"><a href="#확률-분포" class="headerlink" title="확률 분포"></a>확률 분포</h1><p>06.04 확률 분포 함수<br>    누적분포함수 cdf는 다음과 같은 특징이 있다.</p>
<pre><code>* 음의 무한대에 대한 누적분포함수값은 0이다.

$$ 
F(-\infty) = 0
$$

* 양의 무한대에 대한 누적분포함수값은 1이다.

$$ 
F(+\infty) = 1
$$

* 입력이 크면 누적분포함수값은 같거나 커진다.

$$ 
x &gt; y \;\; \rightarrow \;\; F(x) \geq F(y)
$$


이 세 가지 특성에 따라 누적분포함수는 0에서 시작하여 천천히 증가하면서 1로 다가가는 형태를 가진다. 단조증가 성질에 의해 절대로 내려가지는 않는다.
</code></pre>
<p>06.05 결합확률과 조건부확률<br>    ### 결합확률과 조건부확률</p>
<pre><code>베이지안 확률론은 두 사건 $A$와 $B$의 관계를 알고 있다면 사건 $B$가 발생하였했다는 사실로부터 기존에 알고 있는 사건 $A$에 대한 확률 $P(A)$를 좀 더 정확한 확률로 바꿀 수 있는 방법을 알려준다. 이를 위해서는 결합확률과 조건부확률이라는 두 가지 개념을 정의해야 한다.

**결합확률(joint probability)**은 **사건 $A$와 $B$가 동시에 발생할 확률**이다. 즉, 사건(명제/주장) $A$도 진실이고 사건(명제/주장) $
B$도 진실이므로 사건 $A$와 $B$의 교집합의 확률을 계산하는 것과 같다.

$$ 
P(A \cap B) \text&#123; or &#125; P(A, B) 
$$

결합확률과 대비되는 개념으로 결합되지 않는 개별 사건의 확률 $P(A)$ 또는 $P(B)$를 **주변확률(marginal probability)**라고 한다.

또한 $B$가 사실일 경우의 사건 $A$에 대한 확률을
 **사건 $B$에 대한 사건 $A$의 조건부확률(conditional probability)**이라고 하며 다음과 같이 표기한다.
$$ 
P(A | B)
$$

위 수식에서 기호 $|$는 if를 뜻한다. 즉 다음과 같다.

$$
P(A | B) \equiv \text&#123; new &#125; P(A) \text&#123; if &#125; P(B) = 1
$$

이 조건부확률의 값은 다음처럼 정의한다.

$$ 
P(A|B) = \dfrac&#123;P(A,B)&#125;&#123;P(B)&#125;
$$
</code></pre>
<p>06.06 베이즈 정리<br>    ### 피지엠파이를 사용한 베이즈 정리 적용</p>
<pre><code>피지엠파이 패키지는 베이즈 정리에 적용하는 `BayesianModel` 클래스를 제공한다. 베이즈 정리를 적용하려면 조건부확률을 구현하는 `TabularCPD` 클래스를 사용하여 사전확률과 가능도를 구현해야 한다. `TabularCPD` 클래스 객체는 다음과 같이 만든다.

```
TabularCPD(variable, variable_card, value, evidence=None, evidence_card=None)
```

* `variable`: 확률변수의 이름 문자열
* `variable_card`: 확률변수가 가질 수 있는 경우의 수
* `value`: 조건부확률 배열. 하나의 열(column)이 동일 조건을 뜻하므로 하나의 열의 확률 합은 1이어야 한다.
* `evidence`: 조건이 되는 확률변수의 이름 문자열의 리스트
* `evidence_card`: 조건이 되는 확률변수가 가질 수 있는 경우의 수의 리스트

`TabularCPD` 클래스는 원래는 조건부확률을 구현하기 위한 것이지만 `evidence=None`, `evidence_card=None`으로 인수를 주면 일반적인 확률도 구현할 수 있다.

우선 확률변수 X를 이용하여 병에 걸렸을 사전확률 $P(D)=P(X=1)$, 병에 걸리지 않았을 사전확률 $P(D^C)=P(X=0)$를 정의한다.
</code></pre>
<hr>
<h1 id="코드"><a href="#코드" class="headerlink" title="코드"></a>코드</h1><h2 id=""><a href="#" class="headerlink" title=""></a></h2><table>
<thead>
<tr>
<th></th>
<th>코드</th>
<th>결과</th>
</tr>
</thead>
<tbody><tr>
<td>정방행렬</td>
<td>np.diag([1, 2, 3])</td>
<td><pre>array([[1, 0, 0],<br>       [0, 2, 0],<br>       [0, 0, 3]])</pre></td>
</tr>
<tr>
<td>항등행렬</td>
<td>np.identity(3)<br>또는 <br>np.eye(3)</td>
<td><pre>array([[1., 0., 0., 0.], <br>       [0., 1., 0., 0.], <br>       [0., 0., 1., 0.], <br>       [0., 0., 0., 1.]])</pre></td>
</tr>
<tr>
<td>내적</td>
<td>x.T @ y<br> 또는 <br>np.dot(x.T, y)</td>
<td></td>
</tr>
</tbody></table>
<h2 id="numpy-linalg"><a href="#numpy-linalg" class="headerlink" title="numpy.linalg"></a>numpy.linalg</h2><h3 id="linalg-norm"><a href="#linalg-norm" class="headerlink" title="linalg.norm()"></a>linalg.norm()</h3><h3 id="lstsq"><a href="#lstsq" class="headerlink" title="lstsq()"></a><code>lstsq()</code></h3><pre><code class="python">A = np.array([[1, 1, 0], [0, 1, 1], [1, 1, 1], [1, 1, 2]])
b = np.array([[2], [2], [3], [4.1]])
x, resid, rank, s = np.linalg.lstsq(A, b)
x
</code></pre>
<pre><code>array([[1.03333333],
       [0.95      ],
       [1.05      ]])
</code></pre>
<p>인수 : 행렬 $A$와 벡터?$b$<br>return : 최소자승문제(least square problem)의 답 <code>x</code>, 잔차제곱합(residual sum of squares) <code>resid</code>, 랭크(rank) <code>rank</code>, 특잇값(singular value) <code>s</code></p>
<p><code>resid</code>는 잔차벡터의 $e=Ax-b$의 제곱합, 즉 놈의 제곱이다.</p>
<h3 id="matrix-rank"><a href="#matrix-rank" class="headerlink" title="matrix_rank()"></a><code>matrix_rank()</code></h3><p>넘파이 linalg 서브 패키지의 <code>matrix_rank()</code> 함수로 행렬의 랭크를 계산할 수 있다.</p>
<pre><code class="python">X1 = np.array([[1, 3], [2, 4]])
np.linalg.matrix_rank(X1)
</code></pre>
<pre><code>2
</code></pre>

      
       <hr><span style="font-style: italic;color: gray;"> Thanks for reading my post. </span>
    </div>
</article>







    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2021 Chaejin Kim
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="전체 화면 전환 단축키 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
        /* 渲染*/
        function HTMLDecode(text) {
            var temp = document.createElement("div");
            temp.innerHTML = text;
            var output = temp.innerText || temp.textContent;
            temp = null;
            return output;
        }
        if (window.mermaid){
            window.mermaid = null
        }
        $.getScript("//cdn.jsdelivr.net/npm/mermaid@8.4.2/dist/mermaid.min.js", function () {
            var mermaidOptions = JSON.parse(HTMLDecode("{&#34;theme&#34;:&#34;default&#34;,&#34;startOnLoad&#34;:true,&#34;flowchart&#34;:{&#34;useMaxWidth&#34;:false,&#34;htmlLabels&#34;:true}}"))
            if (window.mermaid) {
                mermaid.initialize(mermaidOptions)
                mermaid.contentLoaded()
            }
        })
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 572px;
    }
    .nav.fullscreen {
        margin-right: -572px;
    }
    .nav-left {
        width: 150px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 542px;
        }
        .nav.fullscreen {
            margin-right: -542px;
        }
        .nav-left {
            width: 150px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 542px;
            margin-right: -542px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #3390FF;
    }
    
    

    /*列表样式*/
    
    #post .pjax article .article-entry>ol, #post .pjax article .article-entry>ul, #post .pjax article>ol, #post .pjax article>ul{
        border: #e2dede solid 1px;
        border-radius: 10px;
        padding: 10px 32px 10px 56px;
    }
    #post .pjax article .article-entry li>ol, #post .pjax article .article-entry li>ul,#post .pjax article li>ol, #post .pjax article li>ul{
        padding-top: 5px;
        padding-bottom: 5px;
    }
    #post .pjax article .article-entry>ol>li, #post .pjax article .article-entry>ul>li,#post .pjax article>ol>li, #post .pjax article>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    #post .pjax article .article-entry li>ol>li, #post .pjax article .article-entry li>ul>li,#post .pjax article li>ol>li, #post .pjax article li>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>







</html>
